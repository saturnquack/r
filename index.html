<form 
  method="POST" 
  action="https://script.google.com/macros/s/AKfycbwhUjCxkogNpUhKW1U_q0d8Z2-WB-WR7BNdsukvRqN25Ueu7qVMo6rcmWduyX4nQB3S8g/exec">
  
  Frequency: <input name="Frequency" type="text"> <br><br>
  Alpha Tag: <input name="Alpha Tag" type="text"> <br><br>
  County: <input name="County" type="text"> <br><br>
  State: <input name="State" type="text"> <br><br>

  <label for="dropdown">Mode: </label>
  <select name="Mode" id="dropdown">
      <option value="FM">FM</option>
      <option value="AM">AM</option>
      <option value="P25 I">P25 I</option>
      <option value="P25 II">P25 II</option>
      <option value="DMR">DMR</option>
      <option value="SSB">SSB</option>
  </select><br><br>

  <button type="submit">Send</button>
</form>

<!-- Table to display sheet data -->
<h2>Submitted Data</h2>
<table border="1" id="dataTable">
  <thead>
    <tr id="tableHeader"></tr>
  </thead>
  <tbody id="tableBody"></tbody>
</table>

<script>
  async function fetchData() {
    try {
      const response = await fetch('https://script.google.com/macros/s/AKfycbwhUjCxkogNpUhKW1U_q0d8Z2-WB-WR7BNdsukvRqN25Ueu7qVMo6rcmWduyX4nQB3S8g/exec');
      const data = await response.json();

      if (data.length === 0) return;

      const tableHeader = document.getElementById("tableHeader");
      const tableBody = document.getElementById("tableBody");

      // Clear existing table content
      tableHeader.innerHTML = "";
      tableBody.innerHTML = "";

      // Create table headers
      Object.keys(data[0]).forEach(header => {
        const th = document.createElement("th");
        th.textContent = header;
        tableHeader.appendChild(th);
      });

      // Populate table rows
      data.forEach(row => {
        const tr = document.createElement("tr");
        Object.values(row).forEach(value => {
          const td = document.createElement("td");
          td.textContent = value;
          tr.appendChild(td);
        });
        tableBody.appendChild(tr);
      });
    } catch (error) {
      console.error("Error fetching data:", error);
    }
  }

  // Fetch data when the page loads
  fetchData();
</script>
