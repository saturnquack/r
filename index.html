<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Saturn's Placeholder Name</title>
    <style>
        th {
            cursor: pointer;
            background-color: #f2f2f2;
            padding: 8px;
        }
        th:hover {
            background-color: #ddd;
        }
        .arrow {
            font-size: 12px;
            margin-left: 5px;
        }
    </style>
</head>
<body>
    <h1>Saturn's Placeholder Name</h1>
    <br>

    <form id="radioForm">
        Frequency: <input name="Frequency" type="text" required> <br><br>
        Alpha Tag: <input name="Alpha Tag" type="text" required> <br><br>
        County: <input name="County" type="text"> <br><br>
        State: <input name="State" type="text"> <br><br>

        <label for="dropdown">Mode: </label>   
        <select name="Mode" id="dropdown"> 
            <option value="FM">FM</option>
            <option value="AM">AM</option>
            <option value="P25 I">P25 I</option>
            <option value="P25 II">P25 II</option>
            <option value="DMR">DMR</option>
            <option value="SSB">SSB</option>
        </select><br><br>

        <button type="submit">Send</button>
    </form>

    <h2>Database</h2>
    <table border="1" id="dataTable"> 
        <thead>  
            <tr>
                <th onclick="sortTable('Frequency')">Frequency <span class="arrow" id="FrequencyArrow"></span></th>
                <th onclick="sortTable('Alpha Tag')">Alpha Tag <span class="arrow" id="AlphaTagArrow"></span></th>
                <th onclick="sortTable('County')">County <span class="arrow" id="CountyArrow"></span></th>
                <th onclick="sortTable('State')">State <span class="arrow" id="StateArrow"></span></th>
                <th onclick="sortTable('Mode')">Mode <span class="arrow" id="ModeArrow"></span></th>
                <th onclick="sortTable('Date')">Date <span class="arrow" id="DateArrow"></span></th>
            </tr>
        </thead>
        <tbody id="tableBody"></tbody>
    </table> 

    <footer> 
        <p>@saturn_quack on discord</p>
    </footer> 
  
    <script>
    const form = document.getElementById("radioForm");
    const scriptURL = "https://script.google.com/macros/s/AKfycbzhkJOs15Hfv11r1-nk5lqZE9QCEHFgUNTOULlaD83_QV8MJIYYGKkHWEtWC7S0skc/exec"; // Your Apps Script URL
    let tableData = []; 

    async function fetchData() {
        try {
            const response = await fetch(scriptURL);
            const data = await response.json();
            if (data.length === 0) return;
            tableData = data;
            renderTable(tableData);
        } catch (error) {
            console.error("Error fetching data:", error);
        }
    }

    form.addEventListener("submit", async (e) => {
        e.preventDefault();

        const formData = new FormData(form);
        const data = {
            frequency: formData.get('Frequency'),
            alphaTag: formData.get('Alpha Tag'),
            county: formData.get('County'),
            state: formData.get('State'),
            mode: formData.get('Mode')
        };

        // Send data to Google Apps Script as plain text
        fetch(scriptURL, {
            method: "POST",
            redirect: "follow",
            body: JSON.stringify(data), // JSON encode the data
            headers: { "Content-Type": "text/plain" } // Make sure Content-Type is text/plain
        })
        .then(response => {
            if (response.ok) {
                console.log("Data successfully sent to Google Apps Script");
                form.reset(); // Clear form
                fetchData(); // Optionally, fetch the updated data after submitting
            } else {
                console.error("Error sending data:", response.status);
            }
        })
        .catch(error => {
            console.error("Network error:", error);
        });
    });

    window.onload = fetchData;  // Fetch data immediately when the page loads

    </script>
</body>
</html>
